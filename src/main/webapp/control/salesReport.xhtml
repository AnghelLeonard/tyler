<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:p="http://primefaces.org/ui">
    <h:head>
        <title>Inventory Control - Active</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
        <meta name="viewport" content="user-scalable=no, width=device-width, initial-scale=1.0, maximum-scale=1.0"/>
        <meta name="apple-mobile-web-app-capable" content="yes"/>
    </h:head>
    <h:body>
        <ui:decorate template="../template/layout.xhtml">
            <ui:param name="title" value="true"/>
            <ui:param name="subtitle" value="false"/>
            <ui:param name="mainheader" value="false"/>
            <ui:param name="topmenu" value="true"/>
            <ui:param name="leftpanel" value="true"/>
            <ui:param name="rightpanel" value="true"/>
            <ui:param name="centerpanel" value="true"/>
            <ui:param name="mainfooter" value="true"/>

            <ui:define name="centerpanel">

                <p:ajaxStatus onstart="PF('statusDialog').show()" onsuccess="PF('statusDialog').hide()"/>
                <p:dialog widgetVar="statusDialog" modal="true" closable="false" resizable="false" showHeader="false">
                    <p:graphicImage library="itr" name="images/spinner1.gif" width="50px" height="50px"/>
                </p:dialog>

                <p:growl id="messages" showDetail="false" autoUpdate="true"/>

                <h:form id="salesReport">
                    <h:panelGrid columns="5">
                        <h:outputLabel for="startDate" value="Search from date *:"/>
                        <p:calendar id="startDate" value="#{salesReportBean.startDate}"
                                    placeholder="Select start date" required="true"
                                    requiredMessage="Start date is required."/>

                        <h:outputLabel for="endDate" value="Search until date:"/>
                        <p:calendar id="endDate" value="#{salesReportBean.endDate}"
                                    placeholder="Select end date"/>

                        <p:commandButton value="Search" actionListener="#{salesReportBean.searchBetweenDates()}"
                                         update="@form"/>
                    </h:panelGrid>

                    <p:dataTable id="salesReportTable" value="#{salesReportBean.soldProducts}" var="product">
                        <p:column headerText="Product">
                            <h:outputText value="#{product[0]}"/>
                        </p:column>

                        <p:column headerText="UPC">
                            <h:outputText value="#{product[1]}"/>
                        </p:column>

                        <p:column headerText="Price">
                            <h:outputText value="#{product[2]}"/>
                        </p:column>

                        <p:column headerText="Store">
                            <h:outputText value="#{product[3]}"/>
                        </p:column>

                        <p:column headerText="Sold By">
                            <h:outputText value="#{product[4]}"/>
                        </p:column>

                        <p:column headerText="Sold Date">
                            <h:outputText value="#{product[5]}" converter="localDateTimeConverter"/>
                        </p:column>
                    </p:dataTable>

                    <h:panelGrid columns="3" rendered="#{not empty salesReportBean.soldProducts}">
                        <h4>Export table as:</h4>
                        <h:commandLink>
                            <p:graphicImage library="images" name="file_pdf.png"/>
                            <p:dataExporter type="pdf" target="salesReportTable" fileName="sales_report" pageOnly="false"/>
                        </h:commandLink>
                        <h:commandLink>
                            <p:graphicImage library="images" name="file_excel.png"/>
                            <p:dataExporter type="xls" target="salesReportTable" fileName="sales_report" pageOnly="false"/>
                        </h:commandLink>
                    </h:panelGrid>
                </h:form>

            </ui:define>
        </ui:decorate>
    </h:body>
</html>
